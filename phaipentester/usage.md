# Guía de Uso - PenTesterIA

## Prerequisitos

Antes de usar el framework, necesitas tener corriendo:

### 1. Servidor llama.cpp (LLM)

El framework necesita un modelo de lenguaje local corriendo en el puerto 8080.

**Iniciar llama.cpp**:
```bash
# Ejemplo (ajusta según tu instalación)
llama-server --model /ruta/a/tu/modelo.gguf --port 8080
```

**Verificar que está corriendo**:
```bash
curl http://127.0.0.1:8080/health
```

### 2. Servidor MCP (Model Context Protocol)

El servidor MCP proporciona las herramientas de pentesting.

**Para Web Pentesting**:
```bash
cd /home/nipegun/HackingTools/PenTesterIA/web
python3 mcp-server.py
```

Esto iniciará el servidor MCP en `ws://127.0.0.1:9001`

### 3. Dependencias Python

```bash
pip3 install websockets requests
```

### 4. Herramientas de Pentesting

El framework verificará automáticamente las herramientas necesarias.

---

## Uso Básico

### Opción 1: Usando el Menú Principal (RECOMENDADO)

```bash
# 1. Ve al directorio principal
cd /home/nipegun/HackingTools/PenTesterIA

# 2. Ejecuta el menú
python3 menu.py
```

Verás el menú:
```
[1] Web Application Pentesting
[2] Network Pentesting
[3] Wireless Pentesting
[0] Salir

Selecciona una opción [0-3]:
```

Selecciona `1` para Web Pentesting.

### Opción 2: Ejecutar directamente el framework Web

```bash
cd /home/nipegun/HackingTools/PenTesterIA/web
python3 orchestrator.py
```

---

## Ejemplo de Uso Completo

### Paso 1: Iniciar servicios en terminales separadas

**Terminal 1 - LLM (llama.cpp)**:
```bash
llama-server --model /ruta/modelo.gguf --port 8080
```

**Terminal 2 - Servidor MCP**:
```bash
cd /home/nipegun/HackingTools/PenTesterIA/web
python3 mcp-server.py
```

Deberías ver:
```
MCP Web Pentesting Server escuchando en ws://127.0.0.1:9001
```

**Terminal 3 - Orchestrator**:
```bash
cd /home/nipegun/HackingTools/PenTesterIA
python3 menu.py
```

### Paso 2: Verificación de dependencias

El framework verificará automáticamente las herramientas instaladas:

```
============================================================
VERIFICANDO DEPENDENCIAS DE PENTESTING
============================================================
✓ nmap                 [INSTALADO]
✓ curl                 [INSTALADO]
...
✗ sqlmap               [NO ENCONTRADO]
============================================================

¿Deseas instalar los paquetes faltantes ahora? (s/N):
```

### Paso 3: Definir objetivo

```
Objetivo (URL o dominio, por ejemplo https://ejemplo.com): https://testphp.vulnweb.com
```

El framework creará automáticamente el workspace:
```
Workspace creado: /home/nipegun/pt-web-workspace/testphp_vulnweb_com
  Logs:      /home/nipegun/pt-web-workspace/testphp_vulnweb_com/logs
  Evidence:  /home/nipegun/pt-web-workspace/testphp_vulnweb_com/evidence
  Exploits:  /home/nipegun/pt-web-workspace/testphp_vulnweb_com/exploits
  Report:    /home/nipegun/pt-web-workspace/testphp_vulnweb_com/report
```

### Paso 4: Interactuar con el asistente

```
NiPeGun-PTWeb> Haz un reconocimiento inicial del objetivo
```

El asistente:
1. Usará herramientas MCP (http.get, dirscan, etc.)
2. Analizará respuestas
3. Identificará vulnerabilidades
4. Generará PoCs si encuentra problemas
5. Guardará evidencia automáticamente

### Paso 5: Comandos útiles

```bash
# Reconocimiento inicial
NiPeGun-PTWeb> Haz un reconocimiento completo del objetivo

# Escaneo de directorios
NiPeGun-PTWeb> Escanea directorios usando dirscan

# Prueba de vulnerabilidades específicas
NiPeGun-PTWeb> Busca vulnerabilidades SQL Injection en todos los parámetros

# Generar informe
NiPeGun-PTWeb> Genera el informe final en Markdown y HTML con todos los hallazgos
```

---

## Estructura del Workspace

Cada objetivo genera un workspace organizado:

```
/home/nipegun/pt-web-workspace/{objetivo}/
│
├── logs/                    # Logs de todas las acciones
│   └── 0001_http_get_1733022345_toolcall.json
│
├── evidence/                # Evidencias capturadas
│   ├── 0001_http_get_1733022345_request.txt
│   └── 0001_http_get_1733022345_response.txt
│
├── exploits/                # PoCs generados
│   └── sqli_poc_login.py
│
└── report/                  # Informes
    ├── findings.txt         # Hallazgos incrementales
    ├── final.md            # Informe técnico
    └── final.html          # Informe ejecutivo
```

---

## Solución de Problemas

### Error: "No encuentro pt-web-tools.txt"
- Ya está corregido, ahora usa `tools.txt`

### Error: "Connection refused" al conectar con MCP
- Verifica que `mcp-server.py` esté corriendo
- Revisa el puerto 9001

### Error: "Connection refused" al conectar con llama.cpp
- Verifica que llama.cpp esté corriendo en puerto 8080
- Prueba: `curl http://127.0.0.1:8080/health`

### El modelo no responde correctamente
- Verifica que usas un modelo apropiado (mínimo 7B parámetros)
- Ajusta la temperatura en `orchestrator.py` si es necesario

---

## Consejos de Uso

1. **Sé específico**: "Escanea el puerto 80" es mejor que "haz algo"
2. **Metodología**: Sigue el flujo natural: reconocimiento → enumeración → explotación
3. **Revisa evidencias**: Todas las respuestas se guardan en el workspace
4. **Informes**: Pide informes incrementales durante el proceso
5. **PoCs**: El asistente puede generar y ejecutar PoCs automáticamente

---

## Próximos Pasos

Una vez familiarizado con Web Pentesting, puedes:
- Implementar el framework de Network Pentesting
- Implementar el framework de Wireless Pentesting
- Personalizar el system-prompt para tu metodología
- Agregar nuevas herramientas MCP
